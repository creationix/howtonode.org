<!DOCTYPE html>
<html lang="en">
<!-- Mirrored from localhost:8080/welcome by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 13 Jul 2021 14:00:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8" /><title>Welcome to HowToNode.org - How To Node - NodeJS</title><meta name="description" content="Learn the zen of coding in NodeJS." /><meta name="viewport" content="width=device-width" /><link href="style.css" rel="stylesheet" /><link href="print.css" rel="stylesheet" media="print" /><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="feed.xml" /><link href="favicon.ico" rel="icon" type="image/x-icon" /></head><body><div id="container"><div id="header"><a href="index.html"><img src="logo.png" alt="How to Node" class="logo" /><div class="tagline">The zen of coding in node.js</div></a></div><div id="main"><div class="article"><h1><a href="welcome.html">Welcome to HowToNode.org</a></h1><p class="old-node-warning">HEADS UP! This article was written for an older version of node.&nbsp;More up-to-date information may be available elsewhere.</p><p><strong>How To Node</strong> is a blog featuring projects and tutorials relating to the Node.js project.</p>

<p>This article will describe how the blog works.  Teach a few node concepts and describe how to contribute new articles for others to enjoy.</p>

<h2>Sample App - The node-blog engine.</h2>

<p><strong>UPDATE</strong> - This site now runs on another engine, but this article is still good as a general introduction to node.</p>

<p>This entire site is hosted by an nginx server as static html files.  That's right, you can hit refresh as many times as you want and my node code won't know about it.  Think about it as super page caching.</p>

<p>So where does node come in?  Well there is a small node app running on a high port listening for POST hooks from github.  Every time someone pushes changes to the repository that represents the source of this site, the running node app will regenerate all the static files.</p>

<p>For full source-code to the engine please reference the <a href="http://github.com/creationix/node-blog">node-blog</a> page at github.</p>

<p>For the source to the articles and actual content, see the repository for <a href="http://github.com/creationix/howtonode.org">howtonode.org</a></p>

<h3>Node is different</h3>

<p>Something you'll notice coming from other languages (especially PHP) is that <a href="http://nodejs.org/">node</a> doesn't assume your code is running <em>in</em> a web-server.  In fact it doesn't assume much at all.  This turns out to be a very good thing and we'll see why later.</p>

<p>Also something that will be new is the fact that <strong>all</strong> IO functions are non-blocking and asynchronous.  This allows node to be single threaded at the application layer, but perform very well. Especially for use cases where time is spent in IO wait.</p>

<h3>HTTP Server - Github Hook</h3>

<p>First we need a running http server to listen to POST hooks from <a href="http://github.com/">github</a>.  This is pretty simple in <a href="http://nodejs.org/">node</a> and requires that we run a small http server.</p>

<p>We'll start with a small HTTP server.  Almost straight from the docs.</p>

<div class="snippet"><a href="welcome/server.js" class="code-link">server.js</a><pre><code><span class="kwd">var</span><span class="pln"> http </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'http'</span><span class="pun">);</span><span class="pln"><br /><br />http</span><span class="pun">.</span><span class="pln">createServer</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; setTimeout</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; res</span><span class="pun">.</span><span class="pln">writeHead</span><span class="pun">(</span><span class="lit">200</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Content-Type'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'text/plain'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; res</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(</span><span class="str">'Hello World'</span><span class="pun">);</span><span class="pln"><br />&nbsp; </span><span class="pun">},</span><span class="pln"> </span><span class="lit">2000</span><span class="pun">);</span><span class="pln"><br /></span><span class="pun">}).</span><span class="pln">listen</span><span class="pun">(</span><span class="lit">8000</span><span class="pun">);</span><span class="pln"><br /><br />console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'Server running at http://127.0.0.1:8000/'</span><span class="pun">);</span></code></pre></div>

<p>First we're loading a couple of external libraries.  Node is partially compatible with the CommonJS securable module system.  This means that library developers can write reusable JavaScript code and you can <code>require</code> it into your project.  Loading <code>http</code> allows us to start a standalone HTTP server.</p>

<p>Bascically, this is the order of operations:</p>

<ul>
<li><code>http</code> is loaded and all execution stops until it's done.  <code>require</code> is about the only blocking function in node.</li>
<li>Then http.createServer is called and a function is passed to it.  It returns immediately</li>
<li>Listen is called on the resultant server and returns immediately.</li>
<li><code>console.log</code> is called.  This is also async, so we don't wait for the text to actually appear on the console.</li>
</ul>

<p>Now what happens next starts to get tricky.  Node runs in a single thread of execution, but as soon as a block of synchronous code is done, the event loop runs the next event in the queue.  So what happens next depends on which IO was ready first.  Practically <code>listen</code> and <code>puts</code> both happen pretty quickly, so it doesn't usually matter. Se we'll assume that a message got printed to the console and an HTTP server is running port 8000.</p>

<p>Whenever the server gets a web request, the function we passed in to createServer gets called.  The two arguments <code>req</code> and <code>res</code> stand for request and response.  Our function will also return right away since none of our functions are blocking, so we need these handles to reference the http request later on.  In the example the timeout will be scheduled and the function will end.  Later after the timeout has finished, the function inside it will be executed.  Now, with <code>res</code> in our closure, we send a response to the waiting web browser and close the connection.  Note that we could sleep for 30 seconds and the HTTP server would still be accepting new connections from other clients.  This is the beauty of non-blocking IO.</p>

<p>So to convert this to a Github POST hook, we'll keep it simple and assume all the logic is in another module.</p>

<div class="snippet"><a href="welcome/github-hook.js" class="code-link">github-hook.js</a><pre><code><span class="kwd">var</span><span class="pln"> http </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'http'</span><span class="pun">),</span><span class="pln"><br />&nbsp; &nbsp; rebuild </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'./builder'</span><span class="pun">).</span><span class="pln">rebuild</span><span class="pun">;</span><span class="pln"><br /><br />http</span><span class="pun">.</span><span class="pln">createServer</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; rebuild</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">output</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; res</span><span class="pun">.</span><span class="pln">writeHead</span><span class="pun">(</span><span class="lit">200</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Content-Type'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'text/plain'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; res</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(</span><span class="pln">output</span><span class="pun">);</span><span class="pln"><br />&nbsp; </span><span class="pun">})</span><span class="pln"><br /></span><span class="pun">}).</span><span class="pln">listen</span><span class="pun">(</span><span class="lit">8000</span><span class="pun">);</span><span class="pln"><br /><br />console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'Github hook running at http://127.0.0.1:8000/'</span><span class="pun">);</span></code></pre></div>

<p>So whenever a request is received, we call the external <code>rebuild</code> method.  The reason we pass in a callback instead of getting the return value is because the builder will need to do some of its own IO and can't return a meaningful response right away.  When it's done, we'll be notified and then pass on the output to the browser.</p>

<p>In another article I'll explain how node-blog handles the parallel processing of the various source files and how it synchronizes the output into a single message to give back to the http server.</p>

<h2>Contributing</h2>

<p>This article is getting long enough, but it should be a good intro to node programming.  If you're already a node developer and would like to improve this article and/or write your own then please contribute.</p>

<p>All you have to do is fork or clone the <a href="http://github.com/creationix/howtonode.org">howtonode.org</a> repository and add your content.  If you want to preview the site locally then you can clone <a href="http://github.com/creationix/node-blog">node-blog</a> and run a local instance.  This is not required as long as you trust the markdown conversion process.</p>

<p>Add an author entry for yourself and write your article.  When done send any of the project contributors (<a href="http://github.com/creationix">creationix</a> and <a href="http://github.com/miksago">miksago</a> currently) either an email with a <code>git format-patch</code> or send a github pull requst.  We'll pull it in and it will automatically go live.</p><hr style="clear:both" /><div class="body" id="disqus_thread"></div>
<script type="text/javascript">
//<![CDATA[
var disqus_url = "http://howtonode.org/welcome";
//]]>
</script>
<script src="http://disqus.com/forums/howtonodeorg/embed.js" type="text/javascript"></script><a href="http://disqus.com/forums/howtonodeorg/?url=ref" class="view-thread">View the discussion thread.</a><a href="http://disqus.com/" class="dsq-brlink">blog comments powered by<span class="logo-disqus">Disqus</span></a>
<script type="text/javascript">
//<![CDATA[
(function() {
  var links = document.getElementsByTagName('a');
  var query = '?';
  for(var i = 0; i < links.length; i++) {
    if(links[i].href.indexOf('#disqus_thread') >= 0) {
      query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&amp;';
    }
  }
  document.write('<script charset="utf-8" type="text/javascript" src="//disqus.com/forums/howtonodeorg/get_num_replies.js' + query + '"></' + 'script>');
})();


//]]>
</script>
</div></div><div id="sidebar"><div class="aside author"><h4>About the Author</h4><img src="https://www.gravatar.com/avatar/c953ddd239707998340e1a6fbb3eeb46?r=pg&amp;s=200.jpg&amp;d=identicon" class="headshot" /><dl><dt>Name:</dt><dd>Tim Caswell</dd></dl><dl><dt>Github:</dt><dd><a href="https://github.com/creationix">creationix</a></dd></dl><dl><dt>Twitter:</dt><dd><a href="https://twitter.com/creationix">creationix</a></dd></dl><dl><dt>Location:</dt><dd>Red Lick, TX</dd></dl><dl><dt>Links:</dt><dd><a href="http://creationix.com/">Homepage</a></dd></dl></div><div class="aside"><h4>About this Article</h4><a href="http://twitter.com/share" data-count="horizontal" data-via="creationix" class="twitter-share-button">Tweet</a><script src="http://platform.twitter.com/widgets.js"></script><dl title="Tue Feb 02 2010 10:16:51 GMT-0600 (CST)"><dt>Date Released:</dt><dd>Tuesday, February  2, 2010</dd></dl><dl><dt>Node Version:</dt><dd><a href="http://github.com/joyent/node/tree/v0.1.102">node v0.1.102</a></dd></dl><dl><dt>Code Samples:</dt><dd><ul><li><a href="welcome/server.js">server.js</a></li><li><a href="welcome/github-hook.js">github-hook.js</a></li></ul></dd></dl><dl><dt>Revisions:</dt><dd><ul></ul></dd></dl></div><div class="bubble"><h3>About HowToNode.org</h3>

<p>HowToNode.org is a community supported blog created by <a href="http://creationix.com/">Tim Caswell</a>. The purpose of the blog is to teach how to do various tasks in <a href="http://nodejs.org/">node.js</a> as well as teach fundamental concepts that are needed to write effective code.</p>

<p>This site is powered by <a href="http://github.com/creationix/wheat">Wheat</a>, a git based blogging engine written in <a href="http://nodejs.org/">node.JS</a>.</p>

<p>The content for this site is stored in a <a href="http://github.com/creationix/howtonode.org">git repository</a> that anyone can fork, write an article, and send a pull request. If your article passes the quality standards it will be published and help support the greater node community.</p></div></div><div id="footer"><p>&copy; 2011-2014 Tim Caswell under the MIT license.</p><p>Content and articles are copyrighted to the individual authors. Design by&nbsp;<a href="https://bengourley.co.uk/">Ben Gourley</a>. All code snippets used in the examples are in the public domain.</p><p>Wheat v2 running on node.js v16.4.2</p></div></div>
<script type="text/javascript">
//<![CDATA[
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
try {
var pageTracker = _gat._getTracker("UA-12824411-1");
pageTracker._trackPageview();
} catch(err) {}
//]]>
</script>
</body>
<!-- Mirrored from localhost:8080/welcome by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 13 Jul 2021 14:00:29 GMT -->
</html>